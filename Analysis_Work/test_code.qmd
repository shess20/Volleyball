---
title: "Hypothesis Testing"
format: html
editor: visual
---

Ho: Error term not necessary in the model
Ha: Having an error term improves the model  

```{r}
# Log-likelihood for Model 1 (Three parameters: ace, error, other)
loglik_model1 <- result$value

# Log-likelihood for Model 2 (Two parameters: ace, other)
loglik_model2 <- a$value

# Degrees of freedom difference
df_difference <- 6 - 4  # Model 1 has 6 parameters, Model 2 has 4 parameters

# Likelihood ratio test statistic
LR_statistic <- -2 * (loglik_model2 - loglik_model1)

# p-value
p_value <- pchisq(LR_statistic, df_difference, lower.tail = FALSE)

# Conclusion
if (p_value < 0.05) {
  cat("Reject the null hypothesis. Model 1 (all point types) is significantly better.\n")
} else {
  cat("Fail to reject the null hypothesis. Model 2 (ace/other) is sufficient.\n")
}

# Display test results
cat("Likelihood Ratio Test Statistic:", LR_statistic, "\n")
cat("Degrees of Freedom Difference:", df_difference, "\n")
cat("p-value:", p_value, "\n")

```

Ho: Ace term not necessary in the model 
Ha: Having an ace term improves the model 

```{r}
# Log-likelihood for full model
loglik_model2 <- result$value

# Log-likelihood for error model
loglik_model3 <- e$value

df_difference_2_3 <- 4 - 4  # Model 2 has 4 parameters, Model 3 has 4 parameters

# Likelihood ratio test statistic for Model 2 vs. Model 3
LR_statistic_2_3 <- -2 * (loglik_model3 - loglik_model2)

# p-value for Model 2 vs. Model 3
p_value_2_3 <- pchisq(LR_statistic_2_3, df_difference_2_3, lower.tail = FALSE)

# Conclusion for Model 2 vs. Model 3
if (p_value_2_3 < 0.05) {
  cat("Reject the null hypothesis. The full model is significantly better than error model.\n")
} else {
  cat("Fail to reject the null hypothesis. Error model is sufficient.\n")
}

# Display test results for Model 2 vs. Model 3
cat("Likelihood Ratio Test Statistic (Model 2 vs. Model 3):", LR_statistic_2_3, "\n")
cat("Degrees of Freedom Difference (Model 2 vs. Model 3):", df_difference_2_3, "\n")
cat("p-value (Model 2 vs. Model 3):", p_value_2_3, "\n")

```

