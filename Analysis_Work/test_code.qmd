---
title: "Hypothesis Testing"
format: html
editor: visual
---

Ho: Ace and other only in the model create a better model than full Ha: Having an error term improves the model

```{r}
# Log-likelihood for Model 1 (Three parameters: ace, error, other)
loglik_model1 <- result$value

# Log-likelihood for Model 2 (Two parameters: ace, other)
loglik_model2 <- a$value

# Degrees of freedom difference
df_difference <- 6 - 4  # Model 1 has 6 parameters, Model 2 has 4 parameters

# Likelihood ratio test statistic
LR_statistic <- -2 * (loglik_model2 - loglik_model1)

# p-value
p_value <- pchisq(LR_statistic, df_difference, lower.tail = FALSE)

# Conclusion
if (p_value < 0.05) {
  cat("Reject the null hypothesis. Model 1 (all point types) is significantly better.\n")
} else {
  cat("Fail to reject the null hypothesis. Model 2 (ace/other) is sufficient.\n")
}

# Display test results
cat("Likelihood Ratio Test Statistic:", LR_statistic, "\n")
cat("Degrees of Freedom Difference:", df_difference, "\n")
cat("p-value:", p_value, "\n")

```

Ho: Looking only at error or other creates the better model Ha: Having an ace term improves the model

```{r}
# Log-likelihood for full model
loglik_model2 <- result$value

# Log-likelihood for error model
loglik_model3 <- e$value

df_difference_2_3 <- 6 - 4  # Model 2 has 6 parameters, Model 3 has 4 parameters

# Likelihood ratio test statistic for Model 2 vs. Model 3
LR_statistic_2_3 <- -2 * (loglik_model3 - loglik_model2)

# p-value for Model 2 vs. Model 3
p_value_2_3 <- pchisq(LR_statistic_2_3, df_difference_2_3, lower.tail = FALSE)

# Conclusion for Model 2 vs. Model 3
if (p_value_2_3 < 0.05) {
  cat("Reject the null hypothesis. The full model is significantly better than error model.\n")
} else {
  cat("Fail to reject the null hypothesis. Error model is sufficient.\n")
}

# Display test results for Model 2 vs. Model 3
cat("Likelihood Ratio Test Statistic (Model 2 vs. Model 3):", LR_statistic_2_3, "\n")
cat("Degrees of Freedom Difference (Model 2 vs. Model 3):", df_difference_2_3, "\n")
cat("p-value (Model 2 vs. Model 3):", p_value_2_3, "\n")

```

Null Hypothesis (Ho): Ace Model and error model are both equally good models. Alternative Hypothesis (Ha): Error Model is better than the Ace Model.

```{r}
# Calculate log likelihood for Ace Model (Model 2)
loglik_model2 <- -a$value

# Calculate log likelihood for Error Model (Model 3)
loglik_model3 <- -e$value

# Calculate likelihood ratio test statistic
LR_statistic <- -2 * (loglik_model3 - loglik_model2)

# Degrees of freedom for the models (difference in number of parameters)
df_difference <- 0  # Both models have the same number of parameters

# Compute p-value using chi-square distribution
p_value <- pchisq(LR_statistic, df_difference, lower.tail = FALSE)

# Print results
cat("Likelihood ratio test statistic for Error Model vs. Ace Model:", LR_statistic, "\n")
cat("Degrees of Freedom Difference:", df_difference, "\n")
cat("P-value for Error Model vs. Ace Model:", p_value, "\n")

# Interpretation
if (p_value < 0.05) {
  cat("Reject the null hypothesis. There is evidence to suggest that the Error Model provides a significantly better fit to the data compared to the Ace Model.\n")
} else {
  cat("Fail to reject the null hypothesis. There is no sufficient evidence to conclude that the Error Model is superior to the Ace Model in explaining the observed data patterns.\n")
}

```

Ho: the independent model is sufficient

Ha: the full model is significantly better than the independent model

```{r}
# Log-likelihood for the full model (Model 1)
loglik_full_model <- -result$value  # Negate the result since your function returns negative log-likelihood

# Log-likelihood for the independent model
loglik_independent_model <- -independent_model$value  # Negate the result since your function returns negative log-likelihood

# Degrees of freedom difference (difference in the number of parameters)
df_difference <- 1  # Independent model has 1 parameter (probability of an ace event)

# Likelihood ratio test statistic
LR_statistic <- 2 * (loglik_full_model - loglik_independent_model)

# p-value
p_value <- pchisq(LR_statistic, df_difference, lower.tail = FALSE)

# Print the results
cat("Likelihood Ratio Test Statistic (Full Model vs. Independent Model):", LR_statistic, "\n")
cat("Degrees of Freedom Difference:", df_difference, "\n")
cat("p-value:", p_value, "\n")

# Conclusion
if (p_value < 0.05) {
  cat("Reject the null hypothesis. The full model is significantly better than the independent model.\n")
} else {
  cat("Fail to reject the null hypothesis. The independent model is sufficient.\n")
}
```
